{"job":{"components":{"2030":{"id":2030,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-16,"y":128,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2036],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"customers"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SALES"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sale_amount"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"customer_id"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"sale_date"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DJ_WAREHOUSE"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2031":{"id":2031,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":96,"y":128,"width":32,"height":32,"inputConnectorIDs":[2036],"outputConnectorIDs":[2034],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 0"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"year(\"sale_date\")"},"2":{"slot":2,"type":"STRING","value":"year"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2032":{"id":2032,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":192,"y":128,"width":32,"height":32,"inputConnectorIDs":[2034],"outputConnectorIDs":[2035],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rank 0"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"year"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sale_amount"},"2":{"slot":2,"type":"STRING","value":"Desc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rank"},"2":{"slot":2,"type":"STRING","value":"Top 5 Customer"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"2033":{"id":2033,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":304,"y":112,"width":32,"height":32,"inputConnectorIDs":[2035],"outputConnectorIDs":[5041],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter 0"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Top 5 Customer"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Less than or equal to"},"4":{"slot":4,"type":"STRING","value":"5"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"5040":{"id":5040,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":407,"y":101,"width":32,"height":32,"inputConnectorIDs":[5041],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"customers 0"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SALES"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"year"},"2":{"slot":2,"type":"STRING","value":"sale year"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DJ_WAREHOUSE"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COMPUTE_WH"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"2034":{"id":2034,"sourceID":2031,"targetID":2032},"2035":{"id":2035,"sourceID":2032,"targetID":2033},"2036":{"id":2036,"sourceID":2030,"targetID":2031},"5041":{"id":5041,"sourceID":2033,"targetID":5040}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"task_1","description":"Rank customers based on their total purchase amount per year. Identify the top 5 customers each year and track their ranking over time. (Use RANK())","type":"TRANSFORMATION","tag":"6d9019f7-12a2-4ecf-a4c2-f4d118608c6e"}}